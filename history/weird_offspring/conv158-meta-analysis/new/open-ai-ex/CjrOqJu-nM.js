import{E as c,j as n,bB as Q,dt as X,fg as E,du as _,fh as Y,dk as A,fi as Z,fj as ee,fk as te,fl as ne,d7 as ae,fm as oe,eO as U,fn as z,R as re,T as se,I as D,bx as H}from"./index-CfA4yAo4.js";import{E as ie}from"./D7Fr7Iz-nL.js";import{S as le}from"./C7WUg7E8-I.js";import{P as y}from"./BO-7RmF9wi.js";import{U as ce}from"./7BkxPALTV7.js";const $=[{value:"off",label:"Off"},{value:"orig",label:"Most likely"},{value:"inv",label:"Least likely"},{value:"full",label:"Full spectrum"}];function ue(e){const{disabled:t,value:a,onChange:o}=e,s=c.useMemo(()=>$.find(i=>i.value===a)||$[0],[a]),r=c.useCallback(i=>{i&&i.value!=="off"?o(i.value):o(null)},[o]);return n.jsx(Q,{options:$,value:s,onChange:r,isDisabled:t})}var de=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],F=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,s=String(t).toLowerCase(),r=String(o.getOptionValue(a)).toLowerCase(),i=String(o.getOptionLabel(a)).toLowerCase();return r===s||i===s},q={formatCreateLabel:function(t){return'Create "'.concat(t,'"')},isValidNewOption:function(t,a,o,s){return!(!t||a.some(function(r){return F(t,r,s)})||o.some(function(r){return F(t,r,s)}))},getNewOptionData:function(t,a){return{label:a,value:t,__isNew__:!0}}};function pe(e){var t=e.allowCreateWhileLoading,a=t===void 0?!1:t,o=e.createOptionPosition,s=o===void 0?"last":o,r=e.formatCreateLabel,i=r===void 0?q.formatCreateLabel:r,h=e.isValidNewOption,g=h===void 0?q.isValidNewOption:h,O=e.getNewOptionData,x=O===void 0?q.getNewOptionData:O,b=e.onCreateOption,k=e.options,p=k===void 0?[]:k,f=e.onChange,d=X(e,de),N=d.getOptionValue,P=N===void 0?Z:N,C=d.getOptionLabel,S=C===void 0?ee:C,u=d.inputValue,L=d.isLoading,V=d.isMulti,v=d.value,M=d.name,m=c.useMemo(function(){return g(u,E(v),p,{getOptionValue:P,getOptionLabel:S})?x(u,i(u)):void 0},[i,x,S,P,u,g,p,v]),j=c.useMemo(function(){return(a||!L)&&m?s==="first"?[m].concat(_(p)):[].concat(_(p),[m]):p},[a,s,L,m,p]),R=c.useCallback(function(l,w){if(w.action!=="select-option")return f(l,w);var T=Array.isArray(l)?l:[l];if(T[T.length-1]===m){if(b)b(u);else{var I=x(u,u),J={action:"create-option",name:M,option:I};f(Y(V,[].concat(_(E(v)),[I]),I),J)}return}f(l,w)},[x,u,V,M,m,b,f,v]);return A(A({},d),{},{options:j,onChange:R})}var me=c.forwardRef(function(e,t){var a=te(e),o=pe(a);return c.createElement(ne,ae({ref:t},o))}),he=me;const ge={DropdownIndicator:null,ClearIndicator:e=>n.jsx(U.ClearIndicator,{...e,children:n.jsx(z,{size:"20px"})}),MultiValueRemove:e=>n.jsx(U.MultiValueRemove,{...e,children:n.jsx(z,{size:"14px"})})},xe=e=>({label:e,value:e}),fe=()=>"Enter a sequence",ve=e=>'Add "'.concat(e,'"'),be={container:e=>({...e,fontSize:"14px"}),control:(e,t)=>({...e,backgroundColor:"var(--bg-color)",...t.isFocused?{boxShadow:"var(--input-focus-ring)"}:{borderColor:"var(--gray-200)"}}),multiValue:e=>({...e,height:30,paddingLeft:4,paddingRight:2,alignItems:"center",borderRadius:16}),multiValueRemove:e=>({...e,backgroundColor:"transparent",color:"var(--text-secondary)",borderRadius:12,height:24,width:24,display:"flex",justifyContent:"center",":hover":{backgroundColor:"var(--gray-100)",color:"var(--text-primary)"}}),noOptionsMessage:e=>({...e,padding:"4px"}),option:(e,{isFocused:t,isSelected:a})=>({...e,fontSize:"14px",lineHeight:"20px",padding:"5px 12px",borderRadius:6,display:"flex",alignItems:"center",backgroundColor:a?"var(--green-600)":t?"var(--gray-100)":"var(--bg-color)",":active":{...e[":active"],backgroundColor:a?"var(--green-600)":t?"var(--gray-100)":"var(--bg-color)"}}),menu:e=>({...e,backgroundColor:"var(--elevated)",boxShadow:"var(--shadow)",border:"1px solid var(--gray-100)",marginTop:2}),menuList:e=>({...e,padding:0})};class Ce extends c.PureComponent{constructor(){super(...arguments),this.state={inputValue:""},this.isValidNewOption=(t,a,o)=>t?!o.find(s=>s.value===t):!1,this.handleChange=t=>{this.props.onUpdateValues(t)},this.handleInputChange=t=>{this.setState({inputValue:t})},this.handleKeyDown=t=>{const{inputValue:a}=this.state;if(!a){t.key==="Enter"&&this.setState({inputValue:"↵"});return}switch(t.key){case"Enter":this.setState({inputValue:a+"↵"});break;case"Tab":t.preventDefault(),this.setState({inputValue:""}),this.props.onUpdateValues([...this.props.value||[],xe(a)]);break}}}render(){const{inputValue:t}=this.state;return n.jsx(he,{isDisabled:this.props.disabled,components:ge,inputValue:t,isClearable:!0,isMulti:!0,isValidNewOption:this.isValidNewOption,onChange:this.handleChange,onInputChange:this.handleInputChange,onKeyDown:this.handleKeyDown,value:this.props.value,noOptionsMessage:fe,formatCreateLabel:ve,placeholder:"",styles:be,theme:oe})}}const je=["model","temperature","responseLength","stopSequence","topP","frequencyPenalty","presencePenalty","bestOf","startSequence","restartSequence","logProbs"],B=re.createContext(se.freeform),we=()=>c.useContext(B);function ye(e){return e.map(t=>{const a=t.replace(/(\r\n|\n|\r)/gm,"↵");return{value:a,label:a}})}function _e({children:e,className:t,completionMode:a,onChangeParameter:o,onChangeProbs:s,onChangeRestart:r,onChangeRestartEnabled:i,onChangeStart:h,onChangeStartEnabled:g,onChangeStop:O,model:x,responseLength:b,temperature:k,topP:p,frequencyPenalty:f,presencePenalty:d,bestOf:N,probsType:P,restartSequence:C,restartSequenceEnabled:S,startSequence:u,startSequenceEnabled:L,stopSequence:V}){const v=c.useMemo(()=>ye(V),[V]),M=c.useMemo(()=>u?u.replace(/(\r\n|\n|\r)/gm,"↵"):"",[u]),m=c.useMemo(()=>C?C.replace(/(\r\n|\n|\r)/gm,"↵"):"",[C]),j=c.useMemo(()=>({model:x,responseLength:b,temperature:k,topP:p,frequencyPenalty:f,presencePenalty:d,bestOf:N}),[N,x,f,d,b,k,p]),R=c.useMemo(()=>je.map(l=>{const w=ce[a];if(w&&w.includes(l))return null;switch(l){case"stopSequence":return n.jsx(Oe,{formattedStops:v,onChangeStop:O},l);case"startSequence":return n.jsx(ke,{startSequenceEnabled:L,startForRender:M,onChangeStart:h,onChangeStartEnabled:g},l);case"restartSequence":return n.jsx(Ne,{restartSequenceEnabled:S,restartForRender:m,onChangeRestart:r,onChangeRestartEnabled:i},l);case"logProbs":return s&&n.jsx(Pe,{probsType:P,onChangeProbs:s},l);case"model":return n.jsx(Ve,{onChange:o,value:j[l]},l)}if(!Object.keys(G).includes(l))return null;const T=l;return n.jsx(Le,{id:T,currentEngine:j.model,value:j[T],onChange:o},l)}).filter(Boolean),[a,v,o,s,r,i,h,g,O,j,P,m,S,M,L]);return n.jsx(B.Provider,{value:a,children:n.jsx("div",{className:D(t,"parameter-panel"),children:n.jsxs("div",{className:"parameter-panel-grid",children:[e,R]})})})}function Oe({formattedStops:e,onChangeStop:t,disabled:a}){const o=c.useCallback(s=>{if(!s){t([]);return}const r=s.map(i=>i.value);t(r)},[t]);return n.jsx("div",{className:"stop-sequence-container",children:n.jsx(y,{content:"Up to four sequences where the API will stop generating further tokens. The returned text will not contain the stop sequence.",children:n.jsxs("div",{children:[n.jsxs("div",{className:"body-small control-label",children:[n.jsx("div",{children:"Stop sequences"}),n.jsx("div",{className:"control-note",children:"Enter sequence and press Tab"})]}),n.jsx(Ce,{disabled:a,onUpdateValues:o,value:e})]})})})}function ke({startSequenceEnabled:e,startForRender:t,onChangeStart:a,onChangeStartEnabled:o}){return n.jsx(y,{content:"Text to append after the user's input to format the model for a response.",children:n.jsxs("div",{children:[n.jsx("div",{className:"body-small control-label",children:"Inject start text"}),n.jsxs("div",{className:"inject-text-ta-wrap",children:[n.jsx("textarea",{rows:1,className:D("inject-text-ta",!e&&"off"),value:t,onChange:a}),n.jsx(H,{className:"inject-text-cb",checked:e,onChange:o})]})]})},"start")}function Ne({restartSequenceEnabled:e,restartForRender:t,onChangeRestart:a,onChangeRestartEnabled:o}){return n.jsx(y,{content:"Text to append after the model's generation to continue the patterned structure.",children:n.jsxs("div",{children:[n.jsx("div",{className:"body-small control-label",children:"Inject restart text"}),n.jsxs("div",{className:"inject-text-ta-wrap",children:[n.jsx("textarea",{rows:1,className:D("inject-text-ta",!e&&"off"),value:t,onChange:a}),n.jsx(H,{className:"inject-text-cb",checked:e,onChange:o})]})]})},"restart")}function Pe({probsType:e,onChangeProbs:t}){return n.jsx(y,{interactive:!0,onMouseLeaveDelay:200,content:"Toggle token highlighting which indicates how likely a token was to be generated. Helps to debug a given generation, or see alternative options for a token.",children:n.jsxs("div",{children:[n.jsx("div",{className:D("body-small control-label"),children:"Show probabilities"}),n.jsx(ue,{value:e,onChange:t})]})},"logProbs")}const K=1,Se={bestOf:1,frequencyPenalty:0,presencePenalty:0,responseLength:256,temperature:K,topP:1},Le=({id:e,value:t,onChange:a,currentEngine:o,...s})=>{const r=G[e],i=typeof r.max=="function"?r.max(o):r.max,h=c.useCallback(g=>{a(e,g)},[e,a]);return n.jsx(y,{content:r.explanation,children:n.jsx("div",{children:n.jsx(le,{label:r.label,min:r.min,max:i,step:r.step,value:t,onChange:h,...s},r.backendName)})},r.backendName+"div")},W={id:"model",label:"Model"},Ve=({value:e,onChange:t})=>{const a=c.useCallback(r=>{t(W.id,r)},[t]),o=we(),s=e&&e.id;return n.jsxs("div",{children:[n.jsx(y,{interactive:!0,onMouseLeaveDelay:200,content:n.jsxs(n.Fragment,{children:["The model which will generate the completion. Some models are suitable for natural language tasks, others specialize in code."," ",n.jsx("a",{href:"/docs/models",target:"_blank",rel:"noopener noreferrer",children:"Learn more"}),"."]}),children:n.jsx("div",{className:"body-small control-label",children:W.label})}),n.jsx(ie,{completionMode:o,value:s,onChange:a,variant:"fill",align:"end"})]})};function $e(e){return{...Se,engine:e,temperature:K}}const G={responseLength:{label:"Maximum length",backendName:"length",min:1,max:e=>e?e.maxTokens-1:1,step:1,explanation:n.jsxs("div",{children:["The maximum number of tokens to ",n.jsx("b",{children:"generate"})," shared between the prompt and completion. The exact limit varies by model. (One token is roughly 4 characters for standard English text)"]})},temperature:{label:"Temperature",backendName:"temperature",explanation:"Controls randomness: Lowering results in less random completions. As the temperature approaches zero, the model will become deterministic and repetitive.",min:0,max:2,step:.01},topP:{label:"Top P",backendName:"top_p",explanation:"Controls diversity via nucleus sampling: 0.5 means half of all likelihood-weighted options are considered.",min:0,max:1,step:.01},frequencyPenalty:{label:"Frequency penalty",backendName:"frequency_penalty",explanation:"How much to penalize new tokens based on their existing frequency in the text so far. Decreases the model's likelihood to repeat the same line verbatim.",min:0,max:2,step:.01},presencePenalty:{label:"Presence penalty",backendName:"presence_penalty",explanation:"How much to penalize new tokens based on whether they appear in the text so far. Increases the model's likelihood to talk about new topics.",min:0,max:2,step:.01},bestOf:{label:"Best of",backendName:"best_of",explanation:"Generates multiple completions server-side, and displays only the best. Streaming only works when set to 1. Since it acts as a multiplier on the number of completions, this parameters can eat into your token quota very quickly – use caution!",min:1,max:20,step:1}};export{K as D,Se as I,G as P,Oe as S,_e as a,ye as f,$e as g};
